
Commands from the notebook in the 2nd video:

from sklearn.datasets import load_boston
X, _ = load_boston(return_X_y=True)
X = pd.DataFrame(X)
X.plot(kind='scatter', x=6, y=7)

# normalize the data
mu = X.mean()
sigma = X.std()
Xnorm = (X - mu)/sigma



from scipy.linalg import svd
U, s, Vt = svd(Xnorm, full_matrices=False)
Sigma = np.diag(s)
V = Vt.T

U @ Sigma @ V.T  # Should be Xnorm. Check with np.allclose
np.allclose(Xnorm, U @ Sigma @ V.T)

# Recover original data:
np.allclose(X, mu + sigma * pd.DataFrame(U @ Sigma @ V.T))


4th video:

r = 4
Ur = U[:, :r]
Sigmar = Sigma[:r, :r]
Xrr = Ur @ Sigmar

# Suppose new_data is a new row for the original data
# To project it into the normalized basis:
new_data_normalized = (new_data - mu) / sigma
new_data_projected = new_data_normalized @ V[:,:r]

# Append new row:
Xrr.loc[len(Xrr)] = new_data_projected
